let pokemonRepository=function(){let e=[];function t(){return e}function o(t){let o=Object.keys(t);"object"==typeof t&&null!==t&&["name","detailsUrl"].every(e=>o.includes(e))?e.push(t):console.error("Please provide an object with name and detailsUrl properties")}function n(t){l(t).then(function(){let o=e.indexOf(t);modal.showModal(t.name,t.height,t.imageUrl,o)})}function l(e){return i(),fetch(e.detailsUrl).then(e=>{if(!e.ok)throw Error("Failed to fetch Pokemon details");return e.json()}).then(t=>{e.imageUrl=t.sprites.front_default,e.height=t.height}).catch(r).finally(a)}function i(){if(!document.querySelector(".loading-message")){let e=document.createElement("p");e.innerText="Hold tight, Trainer! Rare finds take time!",e.classList.add("loading-message"),document.body.appendChild(e)}}function a(){let e=document.querySelector(".loading-message");e&&e.remove()}function r(e){a();let t=document.createElement("p");t.innerText=`Error: ${e.message||"Something went wrong!"}`,t.classList.add("error-message"),document.body.appendChild(t),setTimeout(()=>t.remove(),5e3)}return{getAll:t,add:o,addListItem:function e(t,o=!1){let l=document.querySelector(".pokemon-list"),i=document.createElement("li"),a=document.createElement("button");if(a.innerText=t.name,a.classList.add("button-class","list-group-item","list-group-item-action","btn","btn-primary"),i.classList.add("list-group","col-lg-4","col-md-6","col-12"),!function e(t,o){t.addEventListener("click",function(){n(o)})}(a,t),a.setAttribute("data-bs-toggle","modal"),a.setAttribute("data-bs-target","#pokemonModal"),i.appendChild(a),o){let r=document.createElement("p");r.innerText=`Height: ${t.height}`,r.classList.add("pokemon-height"),i.appendChild(r)}l.appendChild(i)},showDetails:n,loadList:function e(){return i(),fetch("https://pokeapi.co/api/v2/pokemon/?limit=150").then(e=>{if(!e.ok)throw Error("Failed to fetch Pokemon list");return e.json()}).then(e=>{e.results.forEach(e=>{o({name:e.name,detailsUrl:e.url})})}).catch(r).finally(a)},loadDetails:l}}(),modal=function(){let e=0,t=document.getElementById("pokemonModal"),o;return document.getElementById("search-input").value="",t.addEventListener("hidden.bs.modal",function(){document.querySelectorAll(".modal-backdrop").forEach(e=>e.remove()),document.body.classList.remove("modal-open"),document.documentElement.classList.remove("modal-open"),window.scrollTo(0,0)}),{showModal:function n(l,i,a,r){let s=document.querySelector(".modal-title"),d=document.querySelector(".modal-body");document.querySelectorAll(".modal-backdrop").forEach(e=>e.remove()),s.innerText=l,d.textContent="";let c=document.createElement("p");c.textContent=`Height: ${i}`;let m=document.createElement("img");m.src=a,m.alt=l,m.loading="lazy",d.appendChild(c),d.appendChild(m),e=r,o&&o.hide(),(o=new bootstrap.Modal(t)).show()},showNextPokemon:function t(){let o=pokemonRepository.getAll();o.length&&(e=(e+1)%o.length,pokemonRepository.showDetails(o[e]))},showPreviousPokemon:function t(){let o=pokemonRepository.getAll();o.length&&(e=(e-1+o.length)%o.length,pokemonRepository.showDetails(o[e]))}}}();function showSuggestions(e){let t=document.getElementById("search-suggestion");if(t.innerHTML="",pokemonRepository.getAll().map(e=>e.name),""===e){t.style.display="none";return}let o=pokemonRepository.getAll().filter(t=>t.name.toLowerCase().includes(e)).slice(0,3);0===o.length?(t.innerHTML='<li class="list-group-item">No Pok\xe9mon spottet.</li>',t.style.display="block"):(t.style.display="block",o.forEach(e=>{let o=document.createElement("li");o.classList.add("list-group-item"),o.innerText=e.name,o.addEventListener("click",function(){document.getElementById("search-input").value=e.name,t.style.display="none",pokemonRepository.showDetails(e)}),t.appendChild(o)}))}function handleSearch(e){let t=pokemonRepository.getAll().find(t=>t.name.toLowerCase()===e);t?(pokemonRepository.showDetails(t),document.getElementById("search-input").value=""):alert("Hmm, nothing here... perhaps it used Teleport!")}function sortPokemon(e){Promise.all(pokemonRepository.getAll().map(e=>e.height?Promise.resolve():pokemonRepository.loadDetails(e))).then(()=>{let t=pokemonRepository.getAll();"name"===e?t.sort((e,t)=>e.name.localeCompare(t.name)):"height"===e&&t.sort((e,t)=>e.height-t.height);let o=document.querySelector(".pokemon-list");o.innerHTML="",t.forEach(e=>{pokemonRepository.addListItem(e,!0)})})}pokemonRepository.loadList().then(function(){pokemonRepository.getAll().forEach(function(e){pokemonRepository.addListItem(e)})}),document.getElementById("search-input").addEventListener("input",function(e){let t=e.target.value.trim().toLowerCase();showSuggestions(t)}),document.getElementById("search-button").addEventListener("click",function(){let e=document.getElementById("search-input").value.trim().toLowerCase();handleSearch(e)}),document.addEventListener("click",function(e){let t=document.getElementById("search-input"),o=document.getElementById("search-suggestion");t.contains(e.target)||o.contains(e.target)||(o.style.display="none")}),document.getElementById("search-form").addEventListener("click",function(e){e.stopPropagation()}),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".dropdown-item").forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();let t=this.getAttribute("data-sort");sortPokemon(t)})})});